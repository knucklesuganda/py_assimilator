
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Assimilator Python framework, Domain-Driven Design, DDD, high performance, easy to learn, fast to code">
      
      
        <meta name="author" content="Andrey Ivanov | Python">
      
      
      <link rel="icon" href="../../images/icon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.10">
    
    
      
        <title>Database - Assimilator - the best Python patterns</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.975780f9.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.2505c338.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-7PEMV9YSS5"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-7PEMV9YSS5",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-7PEMV9YSS5",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>

  
    <script>var consent;"undefined"==typeof __md_analytics||(consent=__md_get("__consent"))&&consent.analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="purple">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#internal-database-patterns" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Assimilator - the best Python patterns" class="md-header__button md-logo" aria-label="Assimilator - the best Python patterns" data-md-component="logo">
      
  <img src="../../images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Assimilator - the best Python patterns
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Database
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="purple"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
            </label>
          
        
          
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/knucklesuganda/py_assimilator" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    knucklesuganda/py_assimilator
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Assimilator - the best Python patterns" class="md-nav__button md-logo" aria-label="Assimilator - the best Python patterns" data-md-component="logo">
      
  <img src="../../images/logo.png" alt="logo">

    </a>
    Assimilator - the best Python patterns
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/knucklesuganda/py_assimilator" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    knucklesuganda/py_assimilator
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/" class="md-nav__link">
        Concepts
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Basic tutorials
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Basic tutorials" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Basic tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/important/" class="md-nav__link">
        Important things
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/database/" class="md-nav__link">
        Database tutorial
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/advanced_database/" class="md-nav__link">
        Advanced database tutorial
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/how_to_create/" class="md-nav__link">
        How to create patterns
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/architecture_tutorial/" class="md-nav__link">
        Architecture tutorial
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          SQLAlchemy
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="SQLAlchemy" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          SQLAlchemy
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../alchemy/database/" class="md-nav__link">
        Database
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Internal
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Internal" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Internal
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Database
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Database
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-patterns-do-we-use" class="md-nav__link">
    What patterns do we use?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-your-models" class="md-nav__link">
    Creating your models
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-our-patterns" class="md-nav__link">
    Creating our patterns
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extending-the-session" class="md-nav__link">
    Extending the session
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-our-patterns" class="md-nav__link">
    Using our patterns
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#internal-specifications" class="md-nav__link">
    Internal Specifications
  </a>
  
    <nav class="md-nav" aria-label="Internal Specifications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#internalfilter" class="md-nav__link">
    InternalFilter
  </a>
  
    <nav class="md-nav" aria-label="InternalFilter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filtering-options" class="md-nav__link">
    Filtering options:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#direct-filters" class="md-nav__link">
    Direct filters:
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#internal_order-specification" class="md-nav__link">
    internal_order specification
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#internal_paginate-specification" class="md-nav__link">
    internal_paginate specification
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#internal_join-specification" class="md-nav__link">
    internal_join specification
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#internal_only-specification" class="md-nav__link">
    internal_only specification
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#internalspecificationlist" class="md-nav__link">
    InternalSpecificationList
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basemodel" class="md-nav__link">
    BaseModel
  </a>
  
    <nav class="md-nav" aria-label="BaseModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basemodel-configuration" class="md-nav__link">
    BaseModel configuration
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#you-can-recreate-that-class-and-change-the-following-values" class="md-nav__link">
    You can recreate that class and change the following values:
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Redis
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Redis" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Redis
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../redis/database/" class="md-nav__link">
        Database
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          MongoDB
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="MongoDB" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          MongoDB
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mongo/database/" class="md-nav__link">
        Database
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../services/" class="md-nav__link">
        Services Tutorial
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../unidentified_patterns/" class="md-nav__link">
        Unidentified Patterns
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../video_tutorials/" class="md-nav__link">
        Video Tutorials
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../help_framework/" class="md-nav__link">
        Help us make the future🤩
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../new_changes/" class="md-nav__link">
        ✨Usability Update(1.3.0)✨
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../next_update/" class="md-nav__link">
        🕢Next update🕢
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-patterns-do-we-use" class="md-nav__link">
    What patterns do we use?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-your-models" class="md-nav__link">
    Creating your models
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-our-patterns" class="md-nav__link">
    Creating our patterns
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extending-the-session" class="md-nav__link">
    Extending the session
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-our-patterns" class="md-nav__link">
    Using our patterns
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#internal-specifications" class="md-nav__link">
    Internal Specifications
  </a>
  
    <nav class="md-nav" aria-label="Internal Specifications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#internalfilter" class="md-nav__link">
    InternalFilter
  </a>
  
    <nav class="md-nav" aria-label="InternalFilter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filtering-options" class="md-nav__link">
    Filtering options:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#direct-filters" class="md-nav__link">
    Direct filters:
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#internal_order-specification" class="md-nav__link">
    internal_order specification
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#internal_paginate-specification" class="md-nav__link">
    internal_paginate specification
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#internal_join-specification" class="md-nav__link">
    internal_join specification
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#internal_only-specification" class="md-nav__link">
    internal_only specification
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#internalspecificationlist" class="md-nav__link">
    InternalSpecificationList
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basemodel" class="md-nav__link">
    BaseModel
  </a>
  
    <nav class="md-nav" aria-label="BaseModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basemodel-configuration" class="md-nav__link">
    BaseModel configuration
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#you-can-recreate-that-class-and-change-the-following-values" class="md-nav__link">
    You can recreate that class and change the following values:
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/knucklesuganda/py_assimilator/edit/master/docs/internal/database.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


<h1 id="internal-database-patterns">Internal Database patterns</h1>
<p>Internal patterns work with Python data structures like dictionary, list, set, and others. You can use that if you don't
have a database yet, or just want to test how things will work in memory.</p>
<h2 id="what-patterns-do-we-use">What patterns do we use?</h2>
<p>Database, in our case, is a dictionary object.</p>
<p>5 main patterns with databases:</p>
<ul>
<li><code>InternalRepository</code> - works with the data. Saves, reads, updates, deletes, modifies, checks, filters our data.</li>
<li><code>InternalUnitOfWork</code> - works with internal transactions. Ensures data integrity. Should only be used when the data is changed.</li>
<li><code>Specification</code> - some sort of filter for the repository. Filters, paginates, joins, limits the results in <code>InternalRepository</code>.</li>
<li><code>InternalSpecificationList</code> - contains links to <code>Specification</code> patterns for indirect coding.</li>
<li><code>LazyCommand</code> - database query that has been created, but not ran yet. Only runs the function when we need the results.</li>
</ul>
<hr />
<h2 id="creating-your-models">Creating your models</h2>
<p>The first thing that you have to do is create your internal models. PyAssimilator uses <a href="https://docs.pydantic.dev/">Pydantic</a>
to develop models that are used as entities. We recommend using our <code>BaseModel</code> class to create your models:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># models.py</span>
<span class="kn">from</span> <span class="nn">assimilator.core.database.models</span> <span class="kn">import</span> <span class="n">BaseModel</span>

<span class="c1"># Just a normal Pydantic model with cool things in it</span>
<span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">username</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">email</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">balance</span><span class="p">:</span> <span class="nb">float</span>
</code></pre></div>
<p>We recommend using <code>BaseModel</code> because it has various features such as:</p>
<ul>
<li>Automatic PyAssimilator configuration for better experience</li>
<li>Parsing from/to JSON</li>
<li>Automatic ID generation</li>
</ul>
<p>But, with that said, you could potentially use <code>BaseModel</code> from <code>Pydantic</code>. However, you are going to need
to create an ID field:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># models.py</span>
<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span>

<span class="c1"># Just a normal Pydantic model</span>
<span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span>     <span class="c1"># id can be any type, but must be unique </span>
    <span class="n">username</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">email</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">balance</span><span class="p">:</span> <span class="nb">float</span>
</code></pre></div>
<h2 id="creating-our-patterns">Creating our patterns</h2>
<p>Once you have your models, you are going to start creating your Internal patterns. We are going to create
<code>InternalUnitOfWork</code> and <code>InternalRepository</code> to manage data and transactions:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># dependencies.py</span>
<span class="kn">from</span> <span class="nn">assimilator.internal.database</span> <span class="kn">import</span> <span class="n">InternalRepository</span><span class="p">,</span> <span class="n">InternalUnitOfWork</span>

<span class="kn">from</span> <span class="nn">models</span> <span class="kn">import</span> <span class="n">User</span>

<span class="n">database</span> <span class="o">=</span> <span class="p">{}</span>   <span class="c1"># our data storage</span>


<span class="k">def</span> <span class="nf">get_repository</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">InternalRepository</span><span class="p">(</span>
        <span class="n">session</span><span class="o">=</span><span class="n">database</span><span class="p">,</span>  <span class="c1"># database session is a dict</span>
        <span class="n">model</span><span class="o">=</span><span class="n">User</span><span class="p">,</span>     <span class="c1"># our main model </span>
    <span class="p">)</span>


<span class="k">def</span> <span class="nf">get_uow</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">InternalUnitOfWork</span><span class="p">(</span><span class="n">repository</span><span class="o">=</span><span class="n">get_repository</span><span class="p">())</span>
</code></pre></div>
<p><code>InternalRepository</code> must accept a <code>dict()</code> for the session and the model that we created.</p>
<ul>
<li><code>session</code> - Python dictionary or it's descendants.</li>
<li><code>model</code> - Pydantic or BaseModel entity that you created.</li>
</ul>
<p>You can also see that instead of exporting our patterns as objects, we create a function that can be called to create
multiple objects whenever needed. The behaviour of creating one object or using object factories depends on your use
case, however, we suggest that you use different objects inside your code.</p>
<h2 id="extending-the-session">Extending the session</h2>
<p>Sometimes we want to use multiple repositories with different entities in them. If that is the case, then
we can use our sessions like this:</p>
<div class="highlight"><pre><span></span><code><span class="n">session</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;users&quot;</span><span class="p">:</span> <span class="p">{},</span>     <span class="c1"># for User entity</span>
    <span class="s2">&quot;products&quot;</span><span class="p">:</span> <span class="p">{},</span>     <span class="c1"># for Product entity</span>
<span class="p">}</span>

<span class="k">def</span> <span class="nf">get_repository</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">InternalRepository</span><span class="p">(</span>
        <span class="n">session</span><span class="o">=</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;users&#39;</span><span class="p">],</span>  <span class="c1"># using nested dict as a session</span>
        <span class="n">model</span><span class="o">=</span><span class="n">User</span><span class="p">,</span>     <span class="c1"># our main model </span>
    <span class="p">)</span>
</code></pre></div>
<h2 id="using-our-patterns">Using our patterns</h2>
<p>You already know how to use the patterns from our Basic Tutorial. So, here is that code again:
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">assimilator.core.database</span> <span class="kn">import</span> <span class="n">UnitOfWork</span><span class="p">,</span> <span class="n">Repository</span>
<span class="kn">from</span> <span class="nn">dependencies</span> <span class="kn">import</span> <span class="n">get_repository</span><span class="p">,</span> <span class="n">get_uow</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">We use base UnitOfWork and Repository annotations in our parameters </span>
<span class="sd">instead of their Internal descendants.</span>
<span class="sd">We suggest you do the same in order to follow SOLID principles. </span>
<span class="sd">&quot;&quot;&quot;</span>


<span class="k">def</span> <span class="nf">create_user</span><span class="p">(</span><span class="n">uow</span><span class="p">:</span> <span class="n">UnitOfWork</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">uow</span><span class="p">:</span>   <span class="c1"># We use that to start the transaction</span>
        <span class="n">repository</span> <span class="o">=</span> <span class="n">uow</span><span class="o">.</span><span class="n">repository</span>   <span class="c1"># access the repository from the InternalUnitOfWork</span>

        <span class="c1"># Save the user using Repository.save() function and by passing all the arguments inside</span>
        <span class="n">new_user</span> <span class="o">=</span> <span class="n">repository</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;Andrey&quot;</span><span class="p">,</span> <span class="n">balance</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

        <span class="c1"># WARNING!!! We have not applied any changes up to that point.</span>
        <span class="c1"># We must call InternalUnitOfWork.commit() to change that: </span>
        <span class="n">uow</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span> 
        <span class="c1"># Changes are applied and used is in the database!</span>

    <span class="k">return</span> <span class="n">new_user</span>

<span class="n">created_user</span> <span class="o">=</span> <span class="n">create_user</span><span class="p">(</span><span class="n">get_uow</span><span class="p">())</span>   <span class="c1"># create our InternalUnitOfWork</span>


<span class="k">def</span> <span class="nf">get_user</span><span class="p">(</span><span class="n">repository</span><span class="p">:</span> <span class="n">Repository</span><span class="p">):</span>    <span class="c1"># only pass the Repository because we want to read the data</span>
    <span class="k">return</span> <span class="n">repository</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>  <span class="c1"># use get() to query one user from the database</span>
        <span class="n">repository</span><span class="o">.</span><span class="n">specs</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>    <span class="c1"># use filter specification to give your filtering criteria</span>
            <span class="n">username</span><span class="o">=</span><span class="s2">&quot;Andrey&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>

<span class="n">user</span> <span class="o">=</span> <span class="n">get_user</span><span class="p">(</span><span class="n">get_repository</span><span class="p">())</span>
</code></pre></div></p>
<p>That's it. Nothing really changes from the basic tutorial, as all the things stay the same in all of our patterns.
However, there are specific things that you may not use, but still need to know. You can read about them below:</p>
<hr />
<h2 id="internal-specifications">Internal Specifications</h2>
<p>When we sort, filter, join and mutate our Internal data, we use Internal specifications. Here is how they work, and what
you can do with them.</p>
<h3 id="internalfilter"><code>InternalFilter</code></h3>
<p><code>InternalFilter</code> is used to filter your data using some filter. You can access it with one of the following
methods(ordered by code quality):</p>
<ol>
<li>
<p>Indirect access from Repository:
<div class="highlight"><pre><span></span><code><span class="c1"># InternalFilter for repositories that use InternalSpecificationList</span>
<span class="n">repository</span><span class="o">.</span><span class="n">specs</span><span class="o">.</span><span class="n">filter</span><span class="p">()</span>
</code></pre></div></p>
</li>
<li>
<p>Direct access using an <code>import</code> statement:
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">assimilator.internal.database.specifications</span> <span class="kn">import</span> <span class="n">InternalFilter</span><span class="p">,</span> <span class="n">internal_filter</span>
<span class="c1"># Both objects are the same</span>

<span class="n">internal_filter</span><span class="p">()</span>
<span class="n">InternalFilter</span><span class="p">()</span>
</code></pre></div></p>
</li>
<li>
<p>Direct access from an <code>InternalSpecificationList</code>:
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">assimilator.internal.database.specifications</span> <span class="kn">import</span> <span class="n">InternalSpecificationList</span>

<span class="n">InternalSpecificationList</span><span class="o">.</span><span class="n">filter</span><span class="p">()</span>
</code></pre></div></p>
</li>
</ol>
<p>If you want to add filters, then you can use filtering options or direct internal filters:</p>
<h5 id="filtering-options">Filtering options:</h5>
<div class="highlight"><pre><span></span><code><span class="n">repository</span><span class="o">.</span><span class="n">specs</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>   <span class="c1"># id == 1</span>
    <span class="n">age__gt</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span>     <span class="c1"># age &gt; 18</span>
    <span class="n">username</span><span class="o">=</span><span class="s2">&quot;Andrey&quot;</span><span class="p">,</span>      <span class="c1"># username == &quot;Andrey&quot;</span>
    <span class="n">user_domain__like</span><span class="o">=</span><span class="s2">&quot;%.com%&quot;</span><span class="p">,</span>     <span class="c1"># user_domain LIKE &quot;%.com%&quot;(yes, it works without SQL!)</span>
<span class="p">)</span>
</code></pre></div>
<p>You can check out our <a href="/tutorial/database/#data-querying">Basic Tutorials</a> for more filtering options.</p>
<h5 id="direct-filters">Direct filters:</h5>
<p>Sometimes you don't want to use filtering options, or you have such a complicated query,
that filtering options do not allow you to fully execute it. Then, you can provide direct filters:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">assimilator.internal.database.specifications</span> <span class="kn">import</span> <span class="n">eq</span>

<span class="n">repository</span><span class="o">.</span><span class="n">specs</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="c1"># The same as username=&quot;Andrey&quot; in filtering options</span>
    <span class="n">eq</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s2">&quot;Andrey&quot;</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div>
<p>Internal direct filters are special functions that can change the query and specify what we want to get.
There is a module with all of them that you can import like this:
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">assimilator.internal.database.specifications</span> <span class="kn">import</span> <span class="n">internal_operator</span>

<span class="n">internal_operator</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s2">&quot;Andrey&quot;</span><span class="p">)</span>
<span class="n">internal_operator</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">)</span>
</code></pre></div></p>
<p>They are written to replicate Python's <a href="https://docs.python.org/3/library/operator.html">operator</a> library. However, there
is another function called <code>find_attribute()</code>, and it is used to find any attribute and call a boolean function on it.
Here is how it works:
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">assimilator.internal.database.specifications</span> <span class="kn">import</span> <span class="n">find_attribute</span>

<span class="c1"># The following function is the same as internal_operator.eq(&#39;username&#39;, &quot;Andrey&quot;)</span>
<span class="n">find_attribute</span><span class="p">(</span>
    <span class="n">func</span><span class="o">=</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">==</span> <span class="n">b</span><span class="p">,</span>   <span class="c1"># boolean function that compares field to value</span>
    <span class="n">field</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">,</span>   <span class="c1"># field that we want to get from an object</span>
    <span class="n">value</span><span class="o">=</span><span class="s2">&quot;Andrey&quot;</span><span class="p">,</span>     <span class="c1"># value that we want to compare our object&#39;s field to</span>
<span class="p">)</span>
</code></pre></div></p>
<p>You can use that function to create your own filters. Be sure to pass a real field with a boolean function:
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">assimilator.internal.database.specifications</span> <span class="kn">import</span> <span class="n">find_attribute</span>


<span class="k">def</span> <span class="nf">only_adult_users</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">find_attribute</span><span class="p">(</span>
        <span class="n">func</span><span class="o">=</span><span class="k">lambda</span> <span class="n">age_field</span><span class="p">,</span> <span class="n">val</span><span class="p">:</span> <span class="n">age_field</span> <span class="o">==</span> <span class="n">val</span><span class="p">,</span>
        <span class="n">field</span><span class="o">=</span><span class="s1">&#39;age&#39;</span><span class="p">,</span>
        <span class="n">value</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span>
    <span class="p">)</span>


<span class="n">repository</span><span class="o">.</span><span class="n">specs</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">only_adult_users</span><span class="p">(),</span>
<span class="p">)</span>
</code></pre></div></p>
<p>But, you can also create specifications. However, when work with internal specifications, we need to
make them a little differently. The thing is, that default Python structures do not support: regex, complex filters, joins,
pagination and so on. So, what we can do is just run the specifications on results instead of the query itself. But, that
would highly impact our algorithms, because sometimes we just need to get a value by its key. So, what do we do?</p>
<p>We break one important programming principle💀 called Single Responsibility Principle. 
Instead of just working with the query, we also write a specification for the list of models. Here is an example: </p>
<div class="highlight"><pre><span></span><code><span class="c1"># specifications.py</span>
<span class="kn">from</span> <span class="nn">assimilator.core.database</span> <span class="kn">import</span> <span class="n">specification</span>


<span class="nd">@specification</span>
<span class="k">def</span> <span class="nf">filter_by_username</span><span class="p">(</span><span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">query</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">username</span> <span class="o">==</span> <span class="s2">&quot;Andrey&quot;</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;1&quot;</span>

    <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">query</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">username</span> <span class="o">==</span> <span class="n">username</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">model</span>

    <span class="k">return</span> <span class="kc">None</span>

<span class="c1"># services.py</span>
<span class="c1"># Then, you call your specification like this:</span>
<span class="n">repository</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">filter_by_username</span><span class="p">(</span><span class="s2">&quot;Andrey&quot;</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div>
<p>Here is what we did:</p>
<ol>
<li>Internal Repository runs your specifications twice - with query as a string(dict key), and with query as a list of models.</li>
<li>We check that if query is a string(the first run), and our username is "Andrey", then we can return a dictionary key(id) which represents that user in the database</li>
<li>Otherwise, we go through each model and check that it's username is "Andrey".</li>
</ol>
<p>Here is what we achieve with that code:</p>
<ol>
<li>If we want to find Andrey in the database - we just return a string key for a dictionary: O(1)</li>
<li>If we can't use a simple algorithm - we go through each user: O(N)</li>
</ol>
<p>It's still a debate if we will leave that or not, but that can optimize our code a lot. Imagine that we have a big
database with millions of users, and we want to find our entity by its ID. If that is the case, that would be very beneficial,
but maybe there is another way of doing so.</p>
<p>IMPORTANT: You don't always need to do something with string query in your specifications. If you are sure that the operation
cannot be used in a normal dictionary indexing, then you can do the following:
<div class="highlight"><pre><span></span><code><span class="c1"># specifications.py</span>
<span class="nd">@specification</span>
<span class="k">def</span> <span class="nf">filter_by_username</span><span class="p">(</span><span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">query</span><span class="p">):</span>
    <span class="c1"># This specification only works with list query</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">query</span>    <span class="c1"># Do not modify the query</span>

    <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">query</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">username</span> <span class="o">==</span> <span class="n">username</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">model</span>

    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></p>
<h3 id="internal_order-specification"><code>internal_order</code> specification</h3>
<p><code>internal_order</code> is a specification that you can use in order to sort your results.
You just provide the columns in your model that are going to be use for sorting.
For example:
<div class="highlight"><pre><span></span><code><span class="c1"># order by username</span>
<span class="n">repository</span><span class="o">.</span><span class="n">specs</span><span class="o">.</span><span class="n">order</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">)</span>

<span class="c1"># order by username and id</span>
<span class="n">repository</span><span class="o">.</span><span class="n">specs</span><span class="o">.</span><span class="n">order</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;username&#39;</span><span class="p">)</span>

<span class="c1"># order by balance DESC with direct import</span>
<span class="kn">from</span> <span class="nn">assimilator.internal.database.specifications</span> <span class="kn">import</span> <span class="n">internal_order</span>
<span class="n">internal_order</span><span class="p">(</span><span class="s1">&#39;-balance&#39;</span><span class="p">)</span>
</code></pre></div></p>
<h3 id="internal_paginate-specification"><code>internal_paginate</code> specification</h3>
<p><code>internal_paginate</code> is a specification that you can use to limit your results
You can provide <code>limit</code> and <code>offset</code> to paginate your data.</p>
<p>For example:
<div class="highlight"><pre><span></span><code><span class="c1"># only first 10</span>
<span class="n">repository</span><span class="o">.</span><span class="n">specs</span><span class="o">.</span><span class="n">paginate</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># all except for first 5</span>
<span class="n">repository</span><span class="o">.</span><span class="n">specs</span><span class="o">.</span><span class="n">paginate</span><span class="p">(</span><span class="n">offset</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># offset by 10 and get the next 10 results</span>
<span class="c1"># with direct import</span>
<span class="kn">from</span> <span class="nn">assimilator.internal.database.specifications</span> <span class="kn">import</span> <span class="n">internal_paginate</span>
<span class="n">internal_paginate</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div></p>
<h3 id="internal_join-specification"><code>internal_join</code> specification</h3>
<p><code>internal_join</code> is a specification that you can use to join multiple models together.
You only use it for back compatibility with other Repositories and to show that you are joining two entities together.
This specification only works as a dummy now. Here it's full code:
<div class="highlight"><pre><span></span><code><span class="nd">@specification</span>
<span class="k">def</span> <span class="nf">internal_join</span><span class="p">(</span><span class="o">*</span><span class="n">targets</span><span class="p">:</span> <span class="n">Collection</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="n">QueryT</span><span class="p">,</span> <span class="o">**</span><span class="n">join_args</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">QueryT</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">query</span>
</code></pre></div></p>
<blockquote>
<p>We don't think that it is necessary to join multiple entities together, and it's really memory inefficient. Instead, we 
suggest that you use composition(store joined object in the model itself) to replicate foreign keys. We have some ideas
on how to do real joins, but it is not implemented yet. </p>
</blockquote>
<p>For example:
<div class="highlight"><pre><span></span><code><span class="c1"># join by relationship name with addresses table</span>
<span class="n">repository</span><span class="o">.</span><span class="n">specs</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;addresses&#39;</span><span class="p">)</span>

<span class="c1"># join multiple entities</span>
<span class="c1"># with direct import</span>
<span class="kn">from</span> <span class="nn">assimilator.internal.database.specifications</span> <span class="kn">import</span> <span class="n">internal_join</span>
<span class="n">internal_join</span><span class="p">(</span><span class="s1">&#39;friends&#39;</span><span class="p">,</span> <span class="s1">&#39;he_he_he_ha&#39;</span><span class="p">)</span>
</code></pre></div></p>
<h3 id="internal_only-specification"><code>internal_only</code> specification</h3>
<p><code>internal_only</code> is a specification that you can use to only select specific columns and optimize your queries.</p>
<p>Examples:
<div class="highlight"><pre><span></span><code><span class="c1"># Get only id and username columns</span>
<span class="n">repository</span><span class="o">.</span><span class="n">specs</span><span class="o">.</span><span class="n">only</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;username&#39;</span><span class="p">)</span>

<span class="c1"># Get only balance column with direct import</span>
<span class="kn">from</span> <span class="nn">assimilator.internal.database.specifications</span> <span class="kn">import</span> <span class="n">internal_only</span>
<span class="n">internal_only</span><span class="p">(</span><span class="s1">&#39;balance&#39;</span><span class="p">)</span>
</code></pre></div></p>
<h3 id="internalspecificationlist"><code>InternalSpecificationList</code></h3>
<p>If you want to create your custom <code>SpecificationList</code> using <code>InternalSpecificationList</code> as a basis, then you can import it
like this:
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">assimilator.internal.database.specifications</span> <span class="kn">import</span> <span class="n">InternalSpecificationList</span>
</code></pre></div></p>
<hr />
<h2 id="basemodel">BaseModel</h2>
<p><code>BaseModel</code> is a special Pydantic model provided by PyAssimilator. It has a lot of interesting settings, and that part
will tell you about that.</p>
<h3 id="basemodel-configuration">BaseModel configuration</h3>
<p><code>BaseModel</code> has a special inner-class called <code>AssimilatorConfig</code>. That class allows you to set up various values for your
model:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">ClassVar</span>

<span class="kn">from</span> <span class="nn">assimilator.core.database</span> <span class="kn">import</span> <span class="n">BaseModel</span>


<span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">username</span><span class="p">:</span> <span class="nb">str</span>

    <span class="k">class</span> <span class="nc">AssimilatorConfig</span><span class="p">:</span>
        <span class="n">autogenerate_id</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># should you autogenerate your ids</span>
</code></pre></div>
<h2 id="you-can-recreate-that-class-and-change-the-following-values">You can recreate that class and change the following values:</h2>
<ul>
<li><code>autogenerate_id</code> - whether to generate model's ID automatically. <code>True</code> by default.</li>
</ul>
<p>If your <code>autogenerate_id</code> is <code>True</code>, then you can still provide a custom ID to the mode:
<div class="highlight"><pre><span></span><code><span class="n">User</span><span class="p">(</span>
    <span class="n">username</span><span class="o">=</span><span class="s2">&quot;Andrey&quot;</span><span class="p">,</span>
    <span class="nb">id</span><span class="o">=</span><span class="n">ObjectId</span><span class="p">(),</span>  <span class="c1"># generate a new mongo ObjectId</span>
<span class="p">)</span>
</code></pre></div></p>
<p>But, if your <code>autogenerate_id</code> is <code>False</code>, then you <strong>must</strong> provide an ID to the constructor. </p>


  




                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../../alchemy/database/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Database" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Database
            </div>
          </div>
        </a>
      
      
        
        <a href="../../redis/database/" class="md-footer__link md-footer__link--next" aria-label="Next: Database" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Database
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023 PyAssimilator
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            

  
    
  


  
    
  



  


<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="analytics" checked>
          <span class="task-list-indicator"></span>
          Google Analytics
        <label>
      </li>
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="github" checked>
          <span class="task-list-indicator"></span>
          GitHub
        <label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var action,form=document.forms.consent;for(action of["submit","reset"])form.addEventListener(action,function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(e){return[e,!0]}))),location.hash="",location.reload()})</script>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["search.suggest", "search.highlight", "content.tabs.link", "navigation.footer"], "search": "../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.5a2dcb6a.min.js"></script>
      
        <script src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8262462913055533"></script>
      
        <script src="/scripts/add_footer.js"></script>
      
        <script src="/scripts/feedback.js"></script>
      
    
    

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
<style>
    .floating-container {
        position: fixed;
        bottom: 20px;
        right: 20px;
        padding: 1em;
        padding-top: 0.5em;
        padding-bottom: 0.5em;
        z-index: 9999;
        background: #673ab6;
        display: flex;
        align-items: center;
        flex-direction: column;
        box-shadow: 0 0 0.2rem #0000001a, 0 0.2rem 0.4rem #0003;
    }

    .floating-container a {
        display: inline-block;
        margin: 5px;
    }

    .floating-container img {
        width: 30px;
    }

    .floating_icon{
        font-size: 28px;
        color: white;
    }

    .glowup:hover{
      transform: scale(1.1);
      transition: 200ms;
      box-shadow: 4px 4px 16px 0 #673ab6;
    }

    .glowup{
      display: block;
    }

    .glowup_forced{
      transform: scale(1.1);
      transition: 200ms;
      box-shadow: 4px 4px 16px 0 #673ab6;
    }

    @media(max-width: 480px) {
      .glowup{
        display: none;
      }
    }
</style>

<div class="floating-container">
    <a href="https://github.com/knucklesuganda/py_assimilator" target="_blank">
        <i class="floating_icon fab fa-github"></i>
    </a>
    <a href="https://discord.gg/WErywR7ert" target="_blank">
        <i class="floating_icon fab fa-discord"></i>
    </a>
    <a href="https://t.me/iv_andrew" target="_blank">
        <i class="floating_icon fab fa-telegram" aria-hidden="true"></i>
    </a>
</div>

    <a href="https://www.donationalerts.com/r/pyassimilator"
       class="floating-container glowup" style="left: 20px; right: initial">
      <h2>Donate and make your own library!</h2>
    </a>

    <script>
      const glowUp = document.querySelector(".glowup");

      setInterval(() => {
        glowUp.classList.add('glowup_forced');

        setTimeout(() => {
          glowUp.classList.remove('glowup_forced');
        }, 3000);
      }, 60000 * 5);
    </script>
  </body>
</html>